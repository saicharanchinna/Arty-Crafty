{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useCallback, useEffect, useState } from 'react';\nimport { CommonService } from \"../../services\";\nimport { Misc } from \"../../../constants\";\nimport { logout, setLoggedInUserData, setLoggedInUserToken } from \"../../../store/actions/account.action\";\nimport { useDispatch } from \"react-redux\";\n// import LoaderComponent from '../loader/loaderComponent';\nimport { useSearchParams } from \"react-router-dom\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst CheckLoginComponent = props => {\n  _s();\n\n  const {\n    children\n  } = props;\n  const dispatch = useDispatch();\n  const [searchParams] = useSearchParams();\n  const [isLoading, setIsLoading] = useState(false);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const checkLogin = useCallback(() => {\n    let token = searchParams.get('token');\n\n    if (token === null) {\n      token = CommonService._localStorage.getItem(Misc.LOCAL_STORAGE_JWT_TOKEN);\n    }\n\n    if (token) {\n      setIsLoading(true);\n\n      CommonService._account.CheckLoginAPICall(token).then(response => {\n        setIsLoading(false);\n        setIsLoaded(true); // @ts-ignore\n\n        dispatch(setLoggedInUserToken(response.data.token));\n        dispatch(setLoggedInUserData(response.data));\n      }).catch(() => {\n        dispatch(logout());\n        setIsLoading(false);\n        setIsLoaded(true);\n      });\n    } else {\n      setIsLoading(false);\n      setIsLoaded(true);\n    }\n  }, [dispatch, searchParams]);\n  useEffect(() => {\n    checkLogin();\n  }, [checkLogin]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [isLoading && !isLoaded && /*#__PURE__*/_jsxDEV(_Fragment, {}, void 0, false), isLoaded && children]\n  }, void 0, true);\n};\n\n_s(CheckLoginComponent, \"4APCznFbDJanM7qynYREIo0HlGQ=\", false, function () {\n  return [useDispatch, useSearchParams];\n});\n\n_c = CheckLoginComponent;\nexport default CheckLoginComponent;\n\nvar _c;\n\n$RefreshReg$(_c, \"CheckLoginComponent\");","map":{"version":3,"names":["React","useCallback","useEffect","useState","CommonService","Misc","logout","setLoggedInUserData","setLoggedInUserToken","useDispatch","useSearchParams","CheckLoginComponent","props","children","dispatch","searchParams","isLoading","setIsLoading","isLoaded","setIsLoaded","checkLogin","token","get","_localStorage","getItem","LOCAL_STORAGE_JWT_TOKEN","_account","CheckLoginAPICall","then","response","data","catch"],"sources":["/Users/saicharanchinna/Documents/Arty-Crafty-UI/src/shared/components/check-login/checkLoginComponent.tsx"],"sourcesContent":["import React, {useCallback, useEffect, useState} from 'react';\nimport {CommonService} from \"../../services\";\nimport {Misc} from \"../../../constants\";\nimport {logout, setLoggedInUserData, setLoggedInUserToken} from \"../../../store/actions/account.action\";\nimport {useDispatch} from \"react-redux\";\nimport {IAPIResponseType} from \"../../models/api.model\";\n// import LoaderComponent from '../loader/loaderComponent';\nimport {useSearchParams} from \"react-router-dom\";\n\ninterface CheckLoginComponentProps {\n\n}\n\nconst CheckLoginComponent = (props: React.PropsWithChildren<CheckLoginComponentProps>) => {\n\n    const {children} = props;\n    const dispatch = useDispatch();\n    const [searchParams] = useSearchParams();\n\n    const [isLoading, setIsLoading] = useState(false);\n    const [isLoaded, setIsLoaded] = useState(false);\n\n    const checkLogin = useCallback(() => {\n        let token = searchParams.get('token');\n        if (token === null){\n            token = CommonService._localStorage.getItem(Misc.LOCAL_STORAGE_JWT_TOKEN);\n        }\n        if (token) {\n            setIsLoading(true);\n            CommonService._account.CheckLoginAPICall(token)\n                .then((response: IAPIResponseType<any>) => {\n                    setIsLoading(false);\n                    setIsLoaded(true);\n                    // @ts-ignore\n                    dispatch(setLoggedInUserToken(response.data.token));\n                    dispatch(setLoggedInUserData(response.data));\n                })\n                .catch(() => {\n                    dispatch(logout());\n                    setIsLoading(false);\n                    setIsLoaded(true);\n                })\n        } else {\n            setIsLoading(false);\n            setIsLoaded(true);\n        }\n    }, [dispatch,searchParams]);\n\n    useEffect(() => {\n        checkLogin();\n    }, [checkLogin]);\n\n    return (\n        <>\n            {(isLoading && !isLoaded) && <>\n                {/*<LoaderComponent>loading ....</LoaderComponent>*/}\n            </>}\n            {isLoaded && children}\n        </>\n    )\n};\n\nexport default CheckLoginComponent;"],"mappings":";;AAAA,OAAOA,KAAP,IAAeC,WAAf,EAA4BC,SAA5B,EAAuCC,QAAvC,QAAsD,OAAtD;AACA,SAAQC,aAAR,QAA4B,gBAA5B;AACA,SAAQC,IAAR,QAAmB,oBAAnB;AACA,SAAQC,MAAR,EAAgBC,mBAAhB,EAAqCC,oBAArC,QAAgE,uCAAhE;AACA,SAAQC,WAAR,QAA0B,aAA1B;AAEA;AACA,SAAQC,eAAR,QAA8B,kBAA9B;;;;AAMA,MAAMC,mBAAmB,GAAIC,KAAD,IAA8D;EAAA;;EAEtF,MAAM;IAACC;EAAD,IAAaD,KAAnB;EACA,MAAME,QAAQ,GAAGL,WAAW,EAA5B;EACA,MAAM,CAACM,YAAD,IAAiBL,eAAe,EAAtC;EAEA,MAAM,CAACM,SAAD,EAAYC,YAAZ,IAA4Bd,QAAQ,CAAC,KAAD,CAA1C;EACA,MAAM,CAACe,QAAD,EAAWC,WAAX,IAA0BhB,QAAQ,CAAC,KAAD,CAAxC;EAEA,MAAMiB,UAAU,GAAGnB,WAAW,CAAC,MAAM;IACjC,IAAIoB,KAAK,GAAGN,YAAY,CAACO,GAAb,CAAiB,OAAjB,CAAZ;;IACA,IAAID,KAAK,KAAK,IAAd,EAAmB;MACfA,KAAK,GAAGjB,aAAa,CAACmB,aAAd,CAA4BC,OAA5B,CAAoCnB,IAAI,CAACoB,uBAAzC,CAAR;IACH;;IACD,IAAIJ,KAAJ,EAAW;MACPJ,YAAY,CAAC,IAAD,CAAZ;;MACAb,aAAa,CAACsB,QAAd,CAAuBC,iBAAvB,CAAyCN,KAAzC,EACKO,IADL,CACWC,QAAD,IAAqC;QACvCZ,YAAY,CAAC,KAAD,CAAZ;QACAE,WAAW,CAAC,IAAD,CAAX,CAFuC,CAGvC;;QACAL,QAAQ,CAACN,oBAAoB,CAACqB,QAAQ,CAACC,IAAT,CAAcT,KAAf,CAArB,CAAR;QACAP,QAAQ,CAACP,mBAAmB,CAACsB,QAAQ,CAACC,IAAV,CAApB,CAAR;MACH,CAPL,EAQKC,KARL,CAQW,MAAM;QACTjB,QAAQ,CAACR,MAAM,EAAP,CAAR;QACAW,YAAY,CAAC,KAAD,CAAZ;QACAE,WAAW,CAAC,IAAD,CAAX;MACH,CAZL;IAaH,CAfD,MAeO;MACHF,YAAY,CAAC,KAAD,CAAZ;MACAE,WAAW,CAAC,IAAD,CAAX;IACH;EACJ,CAxB6B,EAwB3B,CAACL,QAAD,EAAUC,YAAV,CAxB2B,CAA9B;EA0BAb,SAAS,CAAC,MAAM;IACZkB,UAAU;EACb,CAFQ,EAEN,CAACA,UAAD,CAFM,CAAT;EAIA,oBACI;IAAA,WACMJ,SAAS,IAAI,CAACE,QAAf,iBAA4B,qCADjC,EAIKA,QAAQ,IAAIL,QAJjB;EAAA,gBADJ;AAQH,CA/CD;;GAAMF,mB;UAGeF,W,EACMC,e;;;KAJrBC,mB;AAiDN,eAAeA,mBAAf"},"metadata":{},"sourceType":"module"}